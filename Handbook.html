<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>McMaster Smart Classroom - Student Handbook</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/product-sans" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <style>
    /* ====================================================================
      McMaster Smart Classroom - Consolidated Stylesheet
    ====================================================================
    */

    /* --- Global & Foundational Styles --- */
    body {
      font-family: 'Product Sans', sans-serif, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      background-color: #202124;
      color: #e8eaed;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.7;
    }

    code,
    pre {
      font-family: 'Fira Code', 'Courier New', Courier, monospace;
    }

    /* --- Functional CSS (Animations, Scrollbar) --- */
    .page {
      display: none;
    }

    .page.active {
      display: block;
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background-color: #202124;
    }

    ::-webkit-scrollbar-thumb {
      background-color: #3c4043;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background-color: #5f6368;
    }

    /* --- Content-Area Styling (Scoped to '.page') --- */
    .page h1,
    .page h2,
    .page h3,
    .page h4 {
      color: #f1f3f4;
      font-weight: 700;
      border-bottom: 1px solid #3c4043;
      padding-bottom: 8px;
      margin-top: 24px;
      margin-bottom: 16px;
    }

    .page h1 {
      font-size: 2.5em;
      padding-bottom: 12px;
      text-align: center;
    }

    .page h2 {
      font-size: 2em;
    }

    .page h3 {
      font-size: 1.5em;
      border-bottom: none;
    }

    .page h4 {
      font-size: 1.2em;
      color: #bdc1c6;
      border-bottom: none;
      margin-top: 32px;
    }

    .page p {
      font-size: 1em;
      margin-bottom: 16px;
    }

    .page strong,
    .page b {
      color: #e8eaed;
      font-weight: 700;
    }

    .page a {
      color: #8ab4f8;
      text-decoration: none;
      transition: color 0.2s ease-in-out;
    }

    .page a:hover {
      color: #a7c5f9;
      text-decoration: underline;
    }

    .page ul,
    .page ol {
      padding-left: 20px;
    }

    .page li {
      margin-bottom: 8px;
    }

    .page li>p {
      margin-bottom: 0;
    }

    .page table {
      border-collapse: separate;
      border-spacing: 0;
      width: 100%;
      margin: 24px 0;
      border: 1px solid #3c4043;
      border-radius: 8px;
      overflow: hidden;
    }

    .page th,
    .page td {
      border-bottom: 1px solid #3c4043;
      padding: 12px 15px;
      text-align: left;
    }

    .page td {
      border-right: 1px solid #3c4043;
    }

    .page th:last-child,
    .page td:last-child {
      border-right: none;
    }

    .page tbody tr:last-child th,
    .page tbody tr:last-child td {
      border-bottom: none;
    }

    .page thead {
      background-color: #3c4043;
      color: #f1f3f4;
      font-weight: 700;
    }

    .page tbody tr:nth-child(even) {
      background-color: #282a2c;
    }

    .page hr {
      border: none;
      border-top: 1px solid #3c4043;
      margin: 40px 0;
    }

    /* --- Code Block & Syntax Highlighting --- */

    .page :not(pre)>code {
      background-color: #2d2e30;
      border: 1px solid #3c4043;
      padding: 2px 5px;
      font-size: 0.85em;
      border-radius: 6px;
    }

    .page pre {
      background-color: #1e1e1e;
      border: 1px solid #3c4043;
      border-radius: 8px;
      padding: 16px;
      overflow-x: auto;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      margin-top: 16px;
      margin-bottom: 16px;
    }

    .page pre code {
      background-color: transparent;
      border: none;
      padding: 0;
      border-radius: 0;
      font-size: 0.9em;
      line-height: 1.5;
      color: #e8eaed;
    }

    /* Specific syntax highlighting colors */
    .sh-preprocessor {
      color: #c586c0;
    }

    .sh-keyword {
      color: #569cd6;
    }

    .sh-type {
      color: #4ec9b0;
    }

    .sh-function {
      color: #dcdcaa;
    }

    .sh-variable {
      color: #9cdcfe;
    }

    .sh-string {
      color: #ce9178;
    }

    .sh-comment {
      color: #6a9955;
    }

    .sh-literal {
      color: #b5cea8;
    }

    .sh-info {
      color: #4ec9b0;
    }

    .sh-class {
      color: #4ec9b0;
    }

    .sh-operator {
      color: #d4d4d4;
    }

    .sh-number {
      color: #b5cea8;
    }

    .sh-enum {
      color: #47c3ff;
    }

    /* Custom styles for the Overview (Instructor Briefing) page */
    .overview-section-header {
      font-family: 'Product Sans', sans-serif;
      font-weight: 900;
      text-transform: uppercase;
      border-bottom: none !important;
      padding-bottom: 0 !important;
    }

    .overview-card {
      background-color: #2D2E30;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .overview-gradient-heading {
      background: linear-gradient(90deg, #8ab4f8, #c1d9fd);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
    }

    .flow-step-border-accent {
      border-left-color: #8ab4f8;
    }

    .flow-step-border-primary {
      border-left-color: #e8eaed;
    }

    .flow-step-border-secondary {
      border-left-color: #bdc1c6;
    }

    /* New pastel colors for warnings */
    .flow-step-border-warning {
      border-left-color: #ffb300;
      /* Softer amber for border */
    }

    .bg-warning-tint {
      background-color: rgba(255, 179, 0, 0.08);
      /* Very light amber tint */
    }

    .text-error-red-soft {
      color: #ef5350;
      /* A standard Material Design red, kept for strong warning */
    }

    .flow-arrow {
      color: #8ab4f8;
    }

    /* Chart container styling as per requirements */
    .chart-container {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      height: 300px;
      max-height: 400px;
    }

    @media (min-width: 768px) {
      .chart-container {
        height: 350px;
      }
    }

    /* Styles for code blocks within the infographic, to ensure consistency */
    .infographic-code-block pre {
      background-color: #1e1e1e;
      border: 1px solid #3c4043;
      border-radius: 8px;
      padding: 16px;
      overflow-x: auto;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      margin-top: 16px;
      margin-bottom: 16px;
    }

    .infographic-code-block pre code {
      background-color: transparent;
      border: none;
      padding: 0;
      border-radius: 0;
      font-size: 0.9em;
      line-height: 1.5;
      color: #e8eaed;
    }

    /* New styles for modern design elements */
    .highlight-box {
      background-color: rgba(138, 180, 248, 0.08);
      /* Light accent blue with transparency */
      border-left: 4px solid #8ab4f8;
      /* Accent blue border */
      padding: 1.5rem;
      border-radius: 0.75rem;
      margin-bottom: 1rem;
      /* Adjust spacing */
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .highlight-box:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    }

    .icon-large {
      font-size: 3rem;
      /* Larger icons for impact */
      color: #8ab4f8;
      /* Accent color for icons */
      margin-bottom: 0.5rem;
    }
  </style>
  <script>
    // Customizing Tailwind with the color scheme from the handbook
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'custom-bg': '#202124',
            /* Original handbook background */
            'surface': '#2d2e30',
            /* Original handbook surface */
            'primary': '#e8eaed',
            /* Original handbook primary text */
            'secondary': '#bdc1c6',
            /* Original handbook secondary text */
            'accent': '#8ab4f8',
            /* Original handbook accent blue */
            'custom-border': '#3c4043',
            /* Original handbook border */

            /* New colors for errors/warnings and additional blue accents */
            'error-red': '#ef5350',
            /* A standard Material Design red */
            'warning-yellow': '#ffeb3b',
            /* A standard Material Design yellow */
            'info-blue': '#2196f3',
            /* A standard Material Design blue */
            'light-blue-accent': '#c1d9fd',
            /* Lighter shade of accent */

            /* Specific colors for the warning box */
            'warning-tint': 'rgba(255, 179, 0, 0.08)', /* Softer amber tint for background */
            'warning-border-color': '#FFB300', /* Softer amber for border */

            'background-dark': '#202124',
            'card-bg': '#2D2E30',
          },
          borderRadius: {
            '4xl': '2rem',
          },
          fontFamily: {
            product: ['Product Sans', 'sans-serif'],
            /* Only Product Sans for main text */
            fira: ['Fira Code', 'monospace'],
            /* Only Fira Code for code */
          }
        }
      }
    }
  </script>
</head>

<body class="bg-custom-bg text-primary font-product">

  <nav class="sticky top-0 z-50 bg-surface/80 backdrop-blur-md border-b border-custom-border">
    <div class="max-w-5xl mx-auto px-4">
      <div class="flex items-center justify-center h-16">
        <div class="flex items-center space-x-2">
          <a href="#" data-page="home"
            class="nav-item px-4 py-2 text-sm font-medium rounded-xl transition-colors">Home</a>
          <a href="#" data-page="overview"
            class="nav-item px-4 py-2 text-sm font-medium rounded-xl transition-colors">Overview</a>
          <div class="relative" id="dropdown-container">
            <button id="nav-missions-btn" type="button"
              class="nav-item flex items-center px-4 py-2 text-sm font-medium rounded-xl transition-colors focus:outline-none">
              <span>Mission Briefings</span>
              <svg class="ml-2 h-4 w-4 transition-transform duration-200" id="dropdown-arrow"
                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                  d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                  clip-rule="evenodd" />
              </svg>
            </button>
            <div id="dropdown-menu"
              class="hidden absolute mt-2 w-64 bg-surface border border-custom-border rounded-xl shadow-lg py-1">
              <a href="#" class="dropdown-item" data-page="station1">Station 1: HVAC & Appliance</a>
              <a href="#" class="dropdown-item" data-page="station2">Station 2: Environmental Sensors</a>
              <a href="#" class="dropdown-item" data-page="station3">Station 3: Smart Lighting</a>
              <a href="#" class="dropdown-item" data-page="station4">Station 4: Door Security</a>
              <a href="#" class="dropdown-item" data-page="station5">Station 5: Automated Curtain</a>
              <a href="#" class="dropdown-item" data-page="station6">Station 6: Master Control Panel</a>
            </div>
          </div>
          <a href="#" data-page="api-reference"
            class="nav-item px-4 py-2 text-sm font-medium rounded-xl transition-colors">API Reference</a>
          <a href="#" data-page="upload-troubleshoot"
            class="nav-item px-4 py-2 text-sm font-medium rounded-xl transition-colors">Upload &
            Troubleshoot</a>
        </div>
      </div>
    </div>
  </nav>

  <main class="max-w-4xl mx-auto p-4 md:p-8">
    <div id="home" class="page">
      <h1 class="text-4xl md:text-5xl font-bold text-center text-primary mb-4">McMaster Smart Classroom</h1>
      <p class="text-center text-secondary text-lg mb-8">Welcome, Future Engineers! Your mission is to bring this Smart
        Classroom to life. Each team has a critical station to build. This handbook is your guide, providing mission
        briefings and a reference for the <code>SmartDevice</code> library you'll use.</p>

      <hr />

      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">Getting Started: The Universal
        Template</h2>
      <p class="text-secondary">Your journey begins with the <b><code>UniversalDeviceTemplate.ino</code></b> file. This
        template handles all complex networking behind the scenes. Your job is to "fill in the blanks" with your
        station's specific code.</p>

      <h3 class="text-xl font-bold text-primary mb-3">Understanding Your Template</h3>
      <p class="text-secondary">Open the template in your Arduino IDE:
        <code>File > Examples > SmartDevice > UniversalDeviceTemplate</code>.<br>You'll work within <b>5</b> distinct
        sections:
      </p>

      <ol class="list-decimal list-inside pl-4 space-y-4">
        <li>
          <b>Library Inclusions:</b>
          <p class="text-secondary mt-2">At the top, you'll see <code>#include &lt;SmartDevice.h&gt;</code>. Add any
            other libraries your station needs here, like <code>&lt;Servo.h&gt;</code> or <code>&lt;DHT.h&gt;</code>.
          </p>
          <pre><code><span class="sh-comment">// 1. LIBRARY INCLUSIONS</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;SmartDevice.h&gt;</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;Servo.h&gt;</span><span class="sh-comment"> // &lt;-- EXAMPLE!</span></code></pre>
        </li>
        <li>
          <b>Variable Definitions:</b>
          <p class="text-secondary mt-2">Define global variables your program needs, like sensor pins or state flags.
          </p>
          <pre><code><span class="sh-comment">// 2. VARIABLE DEFINITIONS</span>
<span class="sh-keyword">const int</span> <span class="sh-variable">sensorPin</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D1</span>; <span class="sh-comment">// Example for a sensor pin</span>
<span class="sh-keyword">bool</span> <span class="sh-variable">isDeviceOn</span> <span class="sh-operator">=</span> <span class="sh-literal">false</span>; <span class="sh-comment">// Example to track state</span></code></pre>
        </li>
        <li>
          <b>Configuration:</b>
          <p class="text-secondary mt-2">You <b>must</b> change these values to match your station's assignment. Define
            your device name and any communication topics it needs.</p>
          <pre><code><span class="sh-comment">// 3. CONFIGURATION</span>
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">DEVICE_NAME</span> <span class="sh-operator">=</span> <span class="sh-string">"My_Station_Device"</span>; <span class="sh-comment">// &lt;-- CHANGE THIS! e.g., "Sarah_Door_Lock"</span>
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">BASE_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"classroom/some_device"</span>; <span class="sh-comment">// &lt;-- CHANGE for your station</span></code></pre>
        </li>
        <li>
          <b>Object Declarations:</b>
          <p class="text-secondary mt-2">Declare objects from libraries here. The <code>SmartDevice myDevice;</code>
            object is already created for you. Add others as needed.</p>
          <pre><code><span class="sh-comment">// 4. OBJECT DECLARATIONS</span>
<span class="sh-type">SmartDevice</span> <span class="sh-variable">myDevice</span>;
<span class="sh-type">Servo</span> <span class="sh-variable">myServo</span>; <span class="sh-comment">// Example for a servo motor</span></code></pre>
        </li>
        <li>
          <b>Device Functions:</b>
          <p class="text-secondary mt-2">This is where you'll write your station's logic in three key functions:</p>
          <ol class="list-none list-inside pl-4 space-y-4 mt-4">
            <li>
              <b><code>setupDevice()</code>:</b> Runs <b>once</b> at startup. Use it to initialize hardware (e.g., set
              pin modes, start sensors).
              <pre><code><span class="sh-keyword">void</span> <span class="sh-function">setupDevice</span>() {
  <span class="sh-function">pinMode</span>(<span class="sh-keyword">PIN_D7</span>, <span class="sh-literal">OUTPUT</span>); <span class="sh-comment">// Example: Set a pin as an output</span>
  <span class="sh-variable">myDevice</span>.<span class="sh-function">subscribeTo</span>(<span class="sh-variable">BASE_TOPIC</span>); <span class="sh-comment">// Example: Listen for commands</span>
}</code></pre>
            </li>
            <li>
              <b><code>readSensor()</code>:</b> Runs <b>repeatedly</b>. Use it for continuous tasks like reading sensors
              and publishing their data.
              <pre><code><span class="sh-keyword">void</span> <span class="sh-function">readSensor</span>() {
  <span class="sh-keyword">int</span> <span class="sh-variable">sensorValue</span> <span class="sh-operator">=</span> <span class="sh-function">digitalRead</span>(<span class="sh-variable">sensorPin</span>);
  <span class="sh-variable">myDevice</span>.<span class="sh-function">publishTo</span>(<span class="sh-variable">BASE_TOPIC</span>, <span class="sh-type">String</span>(<span class="sh-variable">sensorValue</span>));
}</code></pre>
            </li>
            <li>
              <b><code>triggerActuator(String topic, String command)</code>:</b> Runs <b>only when a command is
                received</b> from the hub. Use it to control actuators like lights or motors.
              <pre><code><span class="sh-keyword">void</span> <span class="sh-function">triggerActuator</span>(<span class="sh-type">String</span> <span class="sh-variable">topic</span>, <span class="sh-type">String</span> <span class="sh-variable">command</span>) {
  <span class="sh-keyword">if</span> (<span class="sh-variable">command</span> <span class="sh-operator">==</span> <span class="sh-string">"true"</span>) {
    <span class="sh-function">digitalWrite</span>(<span class="sh-keyword">PIN_D7</span>, <span class="sh-literal">HIGH</span>); <span class="sh-comment">// Example: Turn something ON</span>
  }
}</code></pre>
            </li>
          </ol>
        </li>
      </ol>

      <hr />

      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">The "System Engine"</h2>
      <p class="text-secondary">Below the sections you modify is the "System Engine" code. It handles all the background
        work of connecting to Wi-Fi and the hub. <b>Do not modify this section.</b> It's the foundation of your project!
      </p>

      <div class="mt-8 bg-accent/10 border border-accent/30 border-l-4 border-l-accent px-6 py-4 rounded-xl">
        <h4 class="font-bold text-lg text-accent mb-2">Network Information</h4>
        <p class="text-sm text-accent/80 mb-3">You will need this for your configuration. It should also be on the main
          whiteboard.</p>
        <ul class="list-disc list-inside text-sm space-y-2">
          <li><b>Wi-Fi Network (SSID):</b> <code>McMasterIoT-Camp</code></li>
          <li><b>Wi-Fi Password:</b> <code>Roomba2025</code></li>
          <li><b>Hub IP Address:</b> <code>192.168.0.147</code> (confirm with instructor)</li>
        </ul>
      </div>
    </div>

    <div id="overview" class="page">
      <!-- Palette: Original Handbook Theme -->
      <!-- Background: #202124, Surface: #2d2e30, Primary: #e8eaed, Secondary: #bdc1c6, Accent: #8ab4f8, Border: #3c4043 -->
      <!-- NEITHER Mermaid JS NOR SVG were used in this output. -->

      <!-- Section 1: The Mission - Introduction -->
      <section class="text-center py-12">
        <h1 class="text-4xl md:text-6xl overview-section-header overview-gradient-heading">Instructor Briefing
        </h1>
        <p class="mt-4 text-lg md:text-xl text-secondary max-w-3xl mx-auto">Welcome, Future Engineers! Your
          mission is to build a living, intelligent classroom system, piece by piece.</p>
        <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
          <div class="overview-card p-6 rounded-2xl">
            <p class="text-6xl font-extrabold text-accent"><span
                class="material-icons text-7xl align-middle">system_update_alt</span></p>
            <p class="mt-2 text-xl font-bold">Integrated System</p>
          </div>
          <div class="overview-card p-6 rounded-2xl">
            <p class="text-6xl font-extrabold text-accent"><span
                class="material-icons text-7xl align-middle">handyman</span></p>
            <p class="mt-2 text-xl font-bold">Specialized Stations</p>
          </div>
          <div class="overview-card p-6 rounded-2xl">
            <p class="text-6xl font-extrabold text-accent"><span
                class="material-icons text-7xl align-middle">rocket_launch</span></p>
            <p class="mt-2 text-xl font-bold">Limitless Innovation</p>
          </div>
        </div>
      </section>

      <!-- Section 2: Your Core Toolkit -->
      <section class="py-12">
        <h2 class="text-3xl md:text-4xl overview-section-header text-center text-primary">Your <span
            class="text-accent">Core Toolkit</span></h2>
        <p class="mt-4 text-lg text-secondary text-center max-w-3xl mx-auto">You'll harness the power of a tiny
          computer and a versatile programming environment.</p>
        <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="overview-card p-8 rounded-2xl text-center">
            <p class="text-4xl"><span class="material-icons text-5xl align-middle">memory</span></p>
            <h3 class="mt-4 text-2xl font-bold text-primary">ESP8266</h3>
            <p class="text-secondary">The compact, Wi-Fi-enabled microcontroller that acts as the brain for
              your IoT device.</p>
          </div>
          <div class="overview-card p-8 rounded-2xl text-center">
            <p class="text-4xl"><span class="material-icons text-5xl align-middle">code</span></p>
            <h3 class="mt-4 text-2xl font-bold text-primary">Arduino IDE</h3>
            <p class="text-secondary">Your integrated development environment for writing, compiling, and
              uploading C++ code to the ESP8266.</p>
          </div>
        </div>
      </section>


      <!-- Section 3: The Universal Template Workflow -->
      <section class="py-12">
        <h2 class="text-3xl md:text-4xl overview-section-header text-center text-primary">Your Workflow: The
          <span class="text-accent">Universal Template</span>
        </h2>
        <p class="mt-4 text-lg text-secondary text-center max-w-3xl mx-auto">Every station begins with the same
          <code>UniversalDeviceTemplate.ino</code>. We've pre-configured the complex networking, so you can
          focus on your unique hardware logic.
        </p>

        <div class="mt-12 grid grid-cols-1 gap-8">
          <!-- Step 1: Configure -->
          <div class="overview-card p-6 rounded-2xl flex items-start gap-4 border-l-4 flow-step-border-accent">
            <div class="flex-shrink-0 text-3xl font-bold text-accent">1</div>
            <div>
              <h3 class="text-2xl font-bold text-primary">Configure Device Identity</h3>
              <p class="text-secondary mt-2">In the "Configuration Section" of your template, you <b>must</b> update the
                <code>DEVICE_NAME</code> and topic variables with the values for your station. This tells the network
                who your device is.
              </p>
              <div
                class="infographic-code-block mt-4 p-3 bg-background-dark rounded-lg font-mono text-sm text-secondary">
                <code><span class="sh-keyword">const char*</span> <span class="sh-variable">DEVICE_NAME</span> = <span class="sh-string">"My_Station_Device"</span>;<span class="sh-comment"> // &lt;-- CHANGE!</span></code><br />
                <code><span class="sh-keyword">const char*</span> <span class="sh-variable">BASE_TOPIC</span> = <span class="sh-string">"classroom/your_topic"</span>;<span class="sh-comment"> // &lt;-- CHANGE!</span></code>
              </div>
            </div>
          </div>
          <div class="text-center text-4xl py-4 flow-arrow">↓</div>

          <!-- Step 2: Write Code in Functions - REVISED DISPLAY -->
          <div class="overview-card p-6 rounded-2xl flex items-start gap-4 border-l-4 flow-step-border-accent">
            <div class="flex-shrink-0 text-3xl font-bold text-accent">2</div>
            <div>
              <h3 class="text-2xl font-bold text-primary">Write Your Logic in Core Functions</h3>
              <p class="text-secondary mt-2">Your specific hardware logic goes into three dedicated functions.
                Understanding when each runs is crucial:</p>

              <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="highlight-box">
                  <span class="material-icons icon-large">build_circle</span>
                  <h4 class="font-bold text-accent"><code>setupDevice()</code></h4>
                  <p class="text-sm text-secondary">Executes <b>ONCE</b> at startup. Ideal for pin configuration
                    (<code>pinMode</code>), sensor initialization, and attaching components.</p>
                </div>
                <div class="highlight-box">
                  <span class="material-icons icon-large">autorenew</span>
                  <h4 class="font-bold text-accent"><code>readSensor()</code></h4>
                  <p class="text-sm text-secondary">Runs <b>REPEATEDLY</b>. Use for continuous sensor readings and
                    publishing data (<code>myDevice.publishTo()</code>).</p>
                </div>
                <div class="highlight-box">
                  <span class="material-icons icon-large">bolt</span>
                  <h4 class="font-bold text-accent"><code>triggerActuator<br>(String topic, String command)</code></h4>
                  <p class="text-sm text-secondary">Executes <b>ON-DEMAND</b> when your device receives a command.
                    Perfect for controlling actuators.</p>
                </div>
              </div>
            </div>
          </div>
          <div class="text-center text-4xl py-4 flow-arrow">↓</div>

          <!-- Step 3: The System Engine - WARNING REVISED -->
          <div
            class="overview-card p-6 rounded-2xl flex items-start gap-4 border-l-4 flow-step-border-warning bg-warning-tint">
            <div class="flex-shrink-0 text-3xl font-bold text-warning-border-color">3</div>
            <div>
              <h3 class="text-2xl font-bold text-primary">The "System Engine": Hands-Off Zone!</h3>
              <p class="text-secondary mt-2">Below your code lies the "System Engine". This handles all Wi-Fi and MQTT
                connections. <b class="text-error-red-soft">DO NOT EDIT THIS SECTION.</b> Changes here could prevent
                your device from connecting.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Section 4: Going Live & Troubleshooting -->
      <section class="py-12">
        <h2 class="text-3xl md:text-4xl overview-section-header text-center text-primary">Going <span
            class="text-accent">Live</span> & Debugging</h2>
        <p class="mt-4 text-lg text-secondary text-center max-w-3xl mx-auto">Even experts hit roadblocks. This guide
          will help you upload your code and tackle common issues.</p>
        <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
          <div class="overview-card p-6 rounded-2xl h-full">
            <h3 class="text-2xl font-bold text-primary">4-Step Code Upload</h3>
            <ol class="mt-4 list-decimal list-inside space-y-3 text-secondary">
              <li><b>Select Board:</b> In Arduino IDE, go to <code>Tools &gt; Board &gt; ESP8266 Boards</code> and
                choose <code>Generic ESP8266 Module</code>.</li>
              <li><b>Select Port:</b> Go to <code>Tools &gt; Port</code> and select the correct serial port. Unplug and
                replug to identify it if needed.</li>
              <li><b>Enter Flash Mode:</b> If uploads fail, hold the "FLASH" or "BOOT" button, plug in the USB, then
                release the button.</li>
              <li><b>Upload & Monitor:</b> Click "Upload" (→). Once done, open the "Serial Monitor" (magnifying glass)
                and set baud rate to <code>115200</code> to see debug messages.</li>
            </ol>
          </div>
          <div class="overview-card p-6 rounded-2xl h-full flex flex-col justify-between">
            <h3 class="text-2xl font-bold text-primary text-center">Common Bug Hotspots</h3>
            <p class="text-secondary text-center mt-2">Know these common issues!</p>
            <div class="chart-container flex-grow pt-4">
              <canvas id="troubleshootingChart"></canvas>
            </div>
            <p class="text-sm text-secondary text-center mt-4">Proportion of common troubleshooting areas.</p>
          </div>
        </div>
        <div class="mt-8 p-6 overview-card rounded-2xl border-l-4 border-accent">
          <h4 class="text-xl font-bold text-accent">Debugging with <code>Serial.println()</code></h4>
          <p class="text-secondary mt-2">Your best debugging tool! Use <code>Serial.println("Your message");</code> to
            print values and see what your device is doing in the Serial Monitor. This is invaluable for finding
            problems!</p>
        </div>
      </section>

      <!-- Section 5: The 6 Stations -->
      <section class="py-12 text-center">
        <h2 class="text-3xl md:text-4xl overview-section-header text-primary">One Team, <span
            class="overview-gradient-heading">Six Missions</span></h2>
        <p class="mt-4 text-lg text-secondary max-w-3xl mx-auto">Each station plays a vital role. Together, you form the
          complete Smart Classroom system!</p>
        <div class="mt-8 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 md:gap-6">
          <div class="overview-card p-4 rounded-2xl">
            <p class="text-4xl"><span class="material-icons text-5xl align-middle">ac_unit</span></p>
            <p class="font-bold mt-2">HVAC</p>
          </div>
          <div class="overview-card p-4 rounded-2xl">
            <p class="text-4xl"><span class="material-icons text-5xl align-middle">thermostat</span></p>
            <p class="font-bold mt-2">Sensors</p>
          </div>
          <div class="overview-card p-4 rounded-2xl">
            <p class="text-4xl"><span class="material-icons text-5xl align-middle">lightbulb</span></p>
            <p class="font-bold mt-2">Lighting</p>
          </div>
          <div class="overview-card p-4 rounded-2xl">
            <p class="text-4xl"><span class="material-icons text-5xl align-middle">lock</span></p>
            <p class="font-bold mt-2">Security</p>
          </div>
          <div class="overview-card p-4 rounded-2xl">
            <p class="text-4xl"><span class="material-icons text-5xl align-middle">blinds_closed</span></p>
            <p class="font-bold mt-2">Curtain</p>
          </div>
          <div class="overview-card p-4 rounded-2xl">
            <p class="text-4xl"><span class="material-icons text-5xl align-middle">tune</span></p>
            <p class="font-bold mt-2">Panel</p>
          </div>
        </div>
      </section>
    </div>

    <div id="station1" class="page">
      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">Station 1: HVAC & Kettle
        Control</h2>
      <h3 class="text-xl font-bold text-primary mb-3">Your Mission: Climate & Convenience Commanders</h3>
      <p class="text-secondary">Your team will give the hub remote control over a fan (HVAC) and a kettle using relay
        modules. Relays act like smart switches, letting your ESP8266 safely turn high-power devices on and off.</p>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Real-World Application:</h4>
      <p class="text-secondary">Think of smart thermostats or smart plugs that let you control any appliance from your
        phone. You're building the core intelligence for such systems.</p>

      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Hardware Kit</h4>
      <ul class="list-disc list-inside pl-4 space-y-1">
        <li>1x ESP8266 Board & Breadboard</li>
        <li>1x Custom HVAC Power Plug (Relay)</li>
        <li>1x Custom Kettle Power Plug (Relay)</li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Wiring Guide</h4>
      <img src="Assets/station1-diagram.png" alt="Wiring Diagram for Station 1"
        class="w-full rounded-2xl my-4 border border-custom-border">
      <ol class="list-decimal list-inside pl-4 space-y-2">
        <li><b>HVAC Relay:</b> Connect its <b>Signal</b> wire to pin <code>PIN_D7</code> and <b>Ground</b> to a
          <code>GND</code> pin.
        </li>
        <li><b>Kettle Relay:</b> Connect its <b>Signal</b> wire to pin <code>PIN_D6</code> and <b>Ground</b> to a
          <code>GND</code> pin.
        </li>
      </ol>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Coding Mission: Step-by-Step</h4>
      <p class="text-secondary">Your station reacts to commands. You'll primarily code in <code>setupDevice()</code> and
        <code>triggerActuator()</code>.
      </p>
      <ul class="list-disc list-inside pl-4 space-y-4">
        <li><b>Variable Definitions & Configuration:</b> Define your relay pins and topic names.
          <pre><code class="language-cpp"><span class="sh-comment">// 2. VARIABLE DEFINITIONS</span>
<span class="sh-keyword">const int</span> <span class="sh-variable">KETTLE_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D6</span>;
<span class="sh-keyword">const int</span> <span class="sh-variable">HVAC_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D7</span>;

<span class="sh-comment">// 3. CONFIGURATION</span>
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">DEVICE_NAME</span> <span class="sh-operator">=</span> <span class="sh-string">"YourName_Appliances"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">KETTLE_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"classroom/kettle"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">HVAC_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"classroom/hvac"</span>;</code></pre>
        </li>
        <li><b><code>setupDevice()</code>:</b> Configure relay pins as outputs, ensure they start OFF, and subscribe to
          their topics.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">setupDevice</span>() {
  <span class="sh-function">pinMode</span>(<span class="sh-variable">HVAC_PIN</span>, <span class="sh-literal">OUTPUT</span>);
  <span class="sh-function">pinMode</span>(<span class="sh-variable">KETTLE_PIN</span>, <span class="sh-literal">OUTPUT</span>);

  <span class="sh-function">digitalWrite</span>(<span class="sh-variable">HVAC_PIN</span>, <span class="sh-literal">LOW</span>); <span class="sh-comment">// Start OFF</span>
  <span class="sh-function">digitalWrite</span>(<span class="sh-variable">KETTLE_PIN</span>, <span class="sh-literal">LOW</span>); <span class="sh-comment">// Start OFF</span>

  <span class="sh-variable">myDevice</span>.<span class="sh-function">subscribeTo</span>(<span class="sh-variable">HVAC_TOPIC</span>);
  <span class="sh-variable">myDevice</span>.<span class="sh-function">subscribeTo</span>(<span class="sh-variable">KETTLE_TOPIC</span>);
}</code></pre>
        </li>
        <li><b><code>triggerActuator(String topic, String command)</code>:</b> Control the correct relay based on the
          topic and command.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">triggerActuator</span>(<span class="sh-type">String</span> <span class="sh-variable">topic</span>, <span class="sh-type">String</span> <span class="sh-variable">command</span>) {
  <span class="sh-keyword">int</span> <span class="sh-variable">pinToControl</span> <span class="sh-operator">=</span> <span class="sh-operator">-</span><span class="sh-literal">1</span>;

  <span class="sh-keyword">if</span> (<span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">HVAC_TOPIC</span>) {
    <span class="sh-variable">pinToControl</span> <span class="sh-operator">=</span> <span class="sh-variable">HVAC_PIN</span>;
  } <span class="sh-keyword">else if</span> (<span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">KETTLE_TOPIC</span>) {
    <span class="sh-variable">pinToControl</span> <span class="sh-operator">=</span> <span class="sh-variable">KETTLE_PIN</span>;
  }

  <span class="sh-keyword">if</span> (<span class="sh-variable">pinToControl</span> <span class="sh-operator">!=</span> <span class="sh-operator">-</span><span class="sh-literal">1</span>) {
    <span class="sh-keyword">if</span> (<span class="sh-variable">command</span> <span class="sh-operator">==</span> <span class="sh-string">"true"</span>) {
      <span class="sh-function">digitalWrite</span>(<span class="sh-variable">pinToControl</span>, <span class="sh-literal">HIGH</span>); <span class="sh-comment">// Turn ON</span>
    } <span class="sh-keyword">else</span> {
      <span class="sh-function">digitalWrite</span>(<span class="sh-variable">pinToControl</span>, <span class="sh-literal">LOW</span>); <span class="sh-comment">// Turn OFF</span>
    }
  }
}</code></pre>
        </li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Success Criteria</h4>
      <p class="text-secondary">Your mission succeeds when you can remotely control the fan and kettle from the central
        dashboard, and their status updates correctly.</p>
    </div>

    <div id="station2" class="page">
      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">Station 2: Environmental &
        Security Sensors</h2>
      <h3 class="text-xl font-bold text-primary mb-3">Your Mission: The Environmental Observers</h3>
      <p class="text-secondary">Your team will monitor the classroom's temperature, motion, and window status
        (open/closed). This data allows for automated climate control and security alerts.</p>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Real-World Application:</h4>
      <p class="text-secondary">Smart homes use these sensors to adjust heating, turn on lights with motion, or send
        alerts if a window is left open. You're building the eyes and ears of such a system.</p>

      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Hardware Kit</h4>
      <ul class="list-disc list-inside pl-4 space-y-1">
        <li>1x ESP8266 Board & Breadboard</li>
        <li>1x DHT11 Temperature & Humidity Sensor</li>
        <li>1x PIR Motion Sensor</li>
        <li>1x Magnetic Reed Switch (Window Sensor)</li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Wiring Guide</h4>
      <img src="Assets/station2-diagram.png" alt="Wiring Diagram for Station 2"
        class="w-full rounded-2xl my-4 border border-custom-border">
      <ol class="list-decimal list-inside pl-4 space-y-2">
        <li><b>DHT11 Sensor:</b> Data to <code>PIN_D2</code>, VCC to <code>3V3</code>, GND to <code>GND</code>.</li>
        <li><b>PIR Motion Sensor:</b> OUT to <code>PIN_D5</code>, VCC to <code>3V3</code>, GND to <code>GND</code>.</li>
        <li><b>Reed Switch (Window):</b> One wire to <code>PIN_D6</code>, the other to <code>GND</code>.</li>
      </ol>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Coding Mission: Step-by-Step</h4>
      <p class="text-secondary">Your station only sends data. You'll primarily code in <code>setupDevice()</code> and
        <code>readSensor()</code>.
      </p>
      <ul class="list-disc list-inside pl-4 space-y-4">
        <li><b>Libraries, Variables, Config & Objects:</b> Set up your libraries, pins, topics, and DHT object.
          <pre><code class="language-cpp"><span class="sh-comment">// 1. LIBRARY INCLUSIONS</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;SmartDevice.h&gt;</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;DHT.h&gt;</span>

<span class="sh-comment">// 2. VARIABLE DEFINITIONS</span>
<span class="sh-keyword">const int</span> <span class="sh-variable">TEMP_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D2</span>;
<span class="sh-keyword">const int</span> <span class="sh-variable">MOTION_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D5</span>;
<span class="sh-keyword">const int</span> <span class="sh-variable">WINDOW_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D6</span>;

<span class="sh-comment">// 3. CONFIGURATION</span>
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">DEVICE_NAME</span> <span class="sh-operator">=</span> <span class="sh-string">"YourName_EnviroSense"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">TEMP_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"classroom/thermostat"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">MOTION_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"classroom/motion"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">WINDOW_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"classroom/window"</span>;

<span class="sh-comment">// 4. OBJECT DECLARATIONS</span>
<span class="sh-class">SmartDevice</span> <span class="sh-variable">myDevice</span>;
<span class="sh-class">DHT</span> <span class="sh-variable">dht</span>(<span class="sh-variable">TEMP_PIN</span>, <span class="sh-keyword">DHT11</span>);</code></pre>
        </li>
        <li><b><code>setupDevice()</code>:</b> Initialize the DHT sensor and configure sensor pins as inputs.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">setupDevice</span>() {
  <span class="sh-variable">dht</span>.<span class="sh-function">begin</span>();
  <span class="sh-function">pinMode</span>(<span class="sh-variable">MOTION_PIN</span>, <span class="sh-literal">INPUT</span>);
  <span class="sh-function">pinMode</span>(<span class="sh-variable">WINDOW_PIN</span>, <span class="sh-literal">INPUT_PULLUP</span>); <span class="sh-comment">// Use internal pull-up</span>
}</code></pre>
        </li>
        <li><b><code>readSensor()</code>:</b> Read all sensors and publish their data to the correct topics.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">readSensor</span>() {
  <span class="sh-keyword">float</span> <span class="sh-variable">temperature</span> <span class="sh-operator">=</span> <span class="sh-variable">dht</span>.<span class="sh-function">readTemperature</span>();
  <span class="sh-keyword">bool</span> <span class="sh-variable">motionDetected</span> <span class="sh-operator">=</span> <span class="sh-function">digitalRead</span>(<span class="sh-variable">MOTION_PIN</span>);
  <span class="sh-keyword">bool</span> <span class="sh-variable">windowOpen</span> <span class="sh-operator">=</span> <span class="sh-operator">!</span><span class="sh-function">digitalRead</span>(<span class="sh-variable">WINDOW_PIN</span>); <span class="sh-comment">// Inverted due to PULLUP</span>

  <span class="sh-keyword">if</span> (<span class="sh-operator">!</span><span class="sh-function">isnan</span>(<span class="sh-variable">temperature</span>)) {
    <span class="sh-variable">myDevice</span>.<span class="sh-function">publishTo</span>(<span class="sh-variable">TEMP_TOPIC</span>, <span class="sh-function">String</span>(<span class="sh-variable">temperature</span>, <span class="sh-literal">1</span>));
  }
  <span class="sh-variable">myDevice</span>.<span class="sh-function">publishTo</span>(<span class="sh-variable">MOTION_TOPIC</span>, <span class="sh-variable">motionDetected</span> ? <span class="sh-string">"true"</span> : <span class="sh-string">"false"</span>);
  <span class="sh-variable">myDevice</span>.<span class="sh-function">publishTo</span>(<span class="sh-variable">WINDOW_TOPIC</span>, <span class="sh-variable">windowOpen</span> ? <span class="sh-string">"true"</span> : <span class="sh-string">"false"</span>);
}</code></pre>
        </li>
        <li><b><code>triggerActuator()</code>:</b> This function can be left empty.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">triggerActuator</span>(<span class="sh-type">String</span> <span class="sh-variable">topic</span>, <span class="sh-type">String</span> <span class="sh-variable">command</span>) {
  <span class="sh-comment">// No actuators for this station.</span>
}</code></pre>
        </li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Success Criteria</h4>
      <p class="text-secondary">Your mission succeeds when the dashboard correctly displays temperature, motion, and
        window status in real-time.</p>
    </div>

    <div id="station3" class="page">
      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">Station 3: Smart Lighting
        &amp; Status Indicator</h2>
      <h3 class="text-xl font-bold text-primary mb-3">Your Mission: Illumination &amp; Information Innovators</h3>
      <p class="text-secondary">Your team will control the classroom's main lighting: a multi-color NeoPixel LED strip
        and a simple dimmable bulb. As an additional challenge, you will also control the <strong>3-color Tower
          Light</strong> from the security station, using it as a visual indicator for the classroom's lock status.</p>

      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Hardware Kit</h4>
      <ul class="list-disc list-inside pl-4 space-y-1">
        <li>1x ESP8266 Board & Breadboard</li>
        <li>1x WS2812B NeoPixel LED Strip</li>
        <li>1x Standard 5mm LED & 220 Ohm Resistor</li>
        <li>1x 3-Color Industrial Tower Light</li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Wiring Guide</h4>
      <img src="Assets/station3-diagram.png" alt="Wiring Diagram for Station 3 with Tower Light"
        class="w-full rounded-2xl my-4 border border-custom-border">
      <ol class="list-decimal list-inside pl-4 space-y-2">
        <li><b>NeoPixel Strip:</b> Data In to <code>PIN_D5</code>, 5V to <code>5V</code>, GND to <code>GND</code>.</li>
        <li><b>Standard LED:</b> Long leg (anode) to a 220 Ohm resistor, resistor to <code>PIN_D6</code>. Short leg
          (cathode) to <code>GND</code>.</li>
        <li><b>Tower Light:</b> Connect the <strong>Red</strong>, <strong>White</strong>, and <strong>Blue</strong>
          signal wires to pins <code>PIN_D0</code>, <code>PIN_D1</code>, and <code>PIN_D4</code> respectively. Connect
          its <strong>Common</strong> wire to <code>GND</code>.</li>
      </ol>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Coding Mission: Step-by-Step</h4>
      <p class="text-secondary">Your station now listens for both lighting commands and lock status commands to control
        all the lights.</p>
      <ul class="list-disc list-inside pl-4 space-y-4">
        <li><b>Libraries, Variables, Config & Objects:</b> Add new variables for the tower light pins and the lock
          status topic.
          <pre><code class="language-cpp"><span class="sh-comment">// 1. LIBRARY INCLUSIONS</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;SmartDevice.h&gt;</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;Adafruit_NeoPixel.h&gt;</span>

<span class="sh-comment">// 2. VARIABLE DEFINITIONS</span>
<span class="sh-keyword">const int</span> <span class="sh-variable">STRIP_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D5</span>;
<span class="sh-keyword">const int</span> <span class="sh-variable">NUM_LEDS</span> <span class="sh-operator">=</span> <span class="sh-literal">6</span>;
<span class="sh-keyword">const int</span> <span class="sh-variable">BULB_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D6</span>;
<span class="sh-keyword">const int</span> <span class="sh-variable">TOWER_RED_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D0</span>;
<span class="sh-keyword">const int</span> <span class="sh-variable">TOWER_WHITE_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D1</span>;
<span class="sh-keyword">const int</span> <span class="sh-variable">TOWER_BLUE_PIN</span> <span class="sh-operator">=</span> <span class="sh-keyword">PIN_D4</span>;

<span class="sh-comment">// 3. CONFIGURATION</span>
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">DEVICE_NAME</span> <span class="sh-operator">=</span> <span class="sh-string">"YourName_Lighting"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">STRIP_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"classroom/lights"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">BULB_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"classroom/light"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">LOCK_STATUS_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"entrance/lock"</span>; <span class="sh-comment">// Listen for lock status</span>

<span class="sh-comment">// 4. OBJECT DECLARATIONS</span>
<span class="sh-class">SmartDevice</span> <span class="sh-variable">myDevice</span>;
<span class="sh-class">Adafruit_NeoPixel</span> <span class="sh-variable">strip</span>(<span class="sh-variable">NUM_LEDS</span>, <span class="sh-variable">STRIP_PIN</span>, <span class="sh-class">NEO_GRB</span> <span class="sh-operator">+</span> <span class="sh-keyword">NEO_KHZ800</span>);</code></pre>
        </li>
        <li><b><code>setupDevice()</code>:</b> Initialize all light pins and subscribe to the new lock topic.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">setupDevice</span>() {
  <span class="sh-variable">strip</span>.<span class="sh-function">begin</span>();
  <span class="sh-variable">strip</span>.<span class="sh-function">show</span>();
  <span class="sh-function">pinMode</span>(<span class="sh-variable">BULB_PIN</span>, <span class="sh-literal">OUTPUT</span>);
  <span class="sh-function">digitalWrite</span>(<span class="sh-variable">BULB_PIN</span>, <span class="sh-literal">LOW</span>);
  
  <span class="sh-function">pinMode</span>(<span class="sh-variable">TOWER_RED_PIN</span>, <span class="sh-literal">OUTPUT</span>);
  <span class="sh-function">pinMode</span>(<span class="sh-variable">TOWER_WHITE_PIN</span>, <span class="sh-literal">OUTPUT</span>);
  <span class="sh-function">pinMode</span>(<span class="sh-variable">TOWER_BLUE_PIN</span>, <span class="sh-literal">OUTPUT</span>);

  <span class="sh-variable">myDevice</span>.<span class="sh-function">subscribeTo</span>(<span class="sh-variable">STRIP_TOPIC</span>);
  <span class="sh-variable">myDevice</span>.<span class="sh-function">subscribeTo</span>(<span class="sh-variable">BULB_TOPIC</span>);
  <span class="sh-variable">myDevice</span>.<span class="sh-function">subscribeTo</span>(<span class="sh-variable">LOCK_STATUS_TOPIC</span>);
}</code></pre>
        </li>
        <li><b><code>triggerActuator(String topic, String command)</code>:</b> Add logic to handle the new topic and
          control the tower light.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">triggerActuator</span>(<span class="sh-type">String</span> <span class="sh-variable">topic</span>, <span class="sh-type">String</span> <span class="sh-variable">command</span>) {
  <span class="sh-keyword">if</span> (<span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">STRIP_TOPIC</span> <span class="sh-operator">||</span> <span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">BULB_TOPIC</span>) {
    <span class="sh-class">SmartHome::Light</span> <span class="sh-variable">lightCommand</span> <span class="sh-operator">=</span> <span class="sh-class">SmartDevice</span>::<span class="sh-function">commandToLight</span>(<span class="sh-variable">command</span>);
    <span class="sh-keyword">if</span> (<span class="sh-operator">!</span><span class="sh-variable">lightCommand</span>.<span class="sh-variable">isOn</span>) {
      <span class="sh-variable">strip</span>.<span class="sh-function">fill</span>(<span class="sh-literal">0</span>);
      <span class="sh-variable">strip</span>.<span class="sh-function">show</span>();
      <span class="sh-function">digitalWrite</span>(<span class="sh-variable">BULB_PIN</span>, <span class="sh-literal">LOW</span>);
    } <span class="sh-keyword">else</span> {
      <span class="sh-keyword">if</span> (<span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">STRIP_TOPIC</span>) {
        <span class="sh-variable">strip</span>.<span class="sh-function">fill</span>(<span class="sh-class">SmartDevice</span>::<span class="sh-function">getRGB</span>(<span class="sh-variable">lightCommand</span>));
        <span class="sh-variable">strip</span>.<span class="sh-function">show</span>();
      } <span class="sh-keyword">else if</span> (<span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">BULB_TOPIC</span>) {
        <span class="sh-function">analogWrite</span>(<span class="sh-variable">BULB_PIN</span>, <span class="sh-class">SmartDevice</span>::<span class="sh-function">getBrightnessValue</span>(<span class="sh-variable">lightCommand</span>));
      }
    }
  } <span class="sh-keyword">else if</span> (<span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">LOCK_STATUS_TOPIC</span>) {
    <span class="sh-keyword">bool</span> <span class="sh-variable">isLocked</span> <span class="sh-operator">=</span> (<span class="sh-variable">command</span> <span class="sh-operator">==</span> <span class="sh-string">"true"</span>);
    <span class="sh-function">digitalWrite</span>(<span class="sh-variable">TOWER_RED_PIN</span>, <span class="sh-variable">isLocked</span>);
    <span class="sh-function">digitalWrite</span>(<span class="sh-variable">TOWER_BLUE_PIN</span>, <span class="sh-operator">!</span><span class="sh-variable">isLocked</span>);
    <span class="sh-function">digitalWrite</span>(<span class="sh-variable">TOWER_WHITE_PIN</span>, <span class="sh-literal">LOW</span>);
  }
}</code></pre>
        </li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Success Criteria</h4>
      <p class="text-secondary">Your mission succeeds when you can control all lights from the dashboard, AND the tower
        light correctly shows red for "locked" and blue for "unlocked" based on commands from Station 4.</p>
    </div>

    <div id="station4" class="page">
      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">Station 4: Door Security (I2C
        Architecture)</h2>
      <h3 class="text-xl font-bold text-primary mb-3">Your Mission: The System Architects</h3>
      <p class="text-secondary">Your team's ESP8266 will act as a high-level manager. It will communicate with a
        dedicated <strong>I2C Door Controller</strong> (a pre-programmed Arduino) that handles all the low-level
        hardware. Your job is to write the code for the ESP8266 to send and receive simple commands over I2C, bridging
        the local hardware with the cloud.</p>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Real-World Application:</h4>
      <p class="text-secondary">This is a professional design pattern! One microcontroller handles networking (the
        ESP8266) while another handles real-time hardware control (the Door Controller). This separation of concerns
        makes systems more reliable and easier to debug.</p>

      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Hardware Kit</h4>
      <ul class="list-disc list-inside pl-4 space-y-1">
        <li>1x ESP8266 Board & Breadboard</li>
        <li>1x Pre-Programmed I2C Door Controller Module</li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Wiring Guide (I2C)</h4>
      <p class="text-secondary mb-4">Your only job is to connect the ESP8266 to the Door Controller module using I2C.
        All other components (servos, keypad, etc.) are already connected to the controller. <strong>Ensure both boards
          share a common Ground
          (GND)!</strong></p>
      <img src="Assets/station4-diagram.png" alt="Wiring Diagram for Station 4 with I2C Module"
        class="w-full rounded-2xl my-4 border border-custom-border">
      <ol class="list-decimal list-inside pl-4 space-y-2">
        <li><strong>I2C Communication:</strong>
          <ul>
            <li>Connect ESP8266 pin <code>PIN_D2</code> (SDA) to the Door Controller's <strong>SDA</strong> pin.</li>
            <li>Connect ESP8266 pin <code>PIN_D1</code> (SCL) to the Door Controller's <strong>SCL</strong> pin.</li>
            <li>Connect a <code>GND</code> pin from the ESP8266 to the Door Controller's <strong>GND</strong> pin.</li>
          </ul>
        </li>
      </ol>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Coding Mission: The ESP8266 Manager</h4>
      <p class="text-secondary">Your code on the ESP8266 will be surprisingly simple. You'll use the <code>Wire</code>
        library to talk to the Door Controller.</p>
      <ul class="list-disc list-inside pl-4 space-y-4">
        <li><b>Libraries, Variables, & Config:</b> Add the <code>Wire.h</code> library for I2C and define the topics and
          the controller's address.
          <pre><code class="language-cpp"><span class="sh-comment">// 1. LIBRARY INCLUSIONS</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;SmartDevice.h&gt;</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;Wire.h&gt;</span> <span class="sh-comment">// For I2C communication</span>

<span class="sh-comment">// 2. VARIABLE DEFINITIONS</span>
<span class="sh-keyword">const int</span> <span class="sh-variable">DOOR_CONTROLLER_ADDRESS</span> <span class="sh-operator">=</span> <span class="sh-literal">0x08</span>;
<span class="sh-keyword">bool</span> <span class="sh-variable">lastReportedLockState</span> <span class="sh-operator">=</span> <span class="sh-literal">false</span>;
<span class="sh-keyword">bool</span> <span class="sh-variable">lastReportedDoorState</span> <span class="sh-operator">=</span> <span class="sh-literal">false</span>;

<span class="sh-comment">// 3. CONFIGURATION</span>
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">DEVICE_NAME</span> <span class="sh-operator">=</span> <span class="sh-string">"YourName_Security_Manager"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">LOCK_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"entrance/lock"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">DOOR_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"entrance/door"</span>;

<span class="sh-comment">// 4. OBJECT DECLARATIONS</span>
<span class="sh-class">SmartDevice</span> <span class="sh-variable">myDevice</span>;</code></pre>
        </li>
        <li><b><code>setupDevice()</code>:</b> Initialize the I2C bus as the Primary and subscribe to the lock command
          topic.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">setupDevice</span>() {
  <span class="sh-class">Wire</span>.<span class="sh-function">begin</span>(<span class="sh-keyword">PIN_D2</span>, <span class="sh-keyword">PIN_D1</span>); <span class="sh-comment">// Initialize I2C bus (SDA, SCL)</span>
  <span class="sh-variable">myDevice</span>.<span class="sh-function">subscribeTo</span>(<span class="sh-variable">LOCK_TOPIC</span>);
}</code></pre>
        </li>
        <li><b><code>readSensor()</code>:</b> Periodically ask the Door Controller for its status and publish any
          changes to the cloud.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">readSensor</span>() {
  <span class="sh-class">Wire</span>.<span class="sh-function">requestFrom</span>(<span class="sh-variable">DOOR_CONTROLLER_ADDRESS</span>, <span class="sh-literal">1</span>); <span class="sh-comment">// Request 1 byte of status data</span>
  
  <span class="sh-keyword">if</span> (<span class="sh-class">Wire</span>.<span class="sh-function">available</span>()) {
    <span class="sh-keyword">byte</span> <span class="sh-variable">statusByte</span> <span class="sh-operator">=</span> <span class="sh-class">Wire</span>.<span class="sh-function">read</span>();
    
    <span class="sh-comment">// Unpack the data from the byte using bitwise operations</span>
    <span class="sh-keyword">bool</span> <span class="sh-variable">isDoorOpen</span> <span class="sh-operator">=</span> (<span class="sh-variable">statusByte</span> <span class="sh-operator">&gt;&gt;</span> <span class="sh-literal">0</span>) <span class="sh-operator">&amp;</span> <span class="sh-literal">1</span>;
    <span class="sh-keyword">bool</span> <span class="sh-variable">isLocked</span>   <span class="sh-operator">=</span> (<span class="sh-variable">statusByte</span> <span class="sh-operator">&gt;&gt;</span> <span class="sh-literal">1</span>) <span class="sh-operator">&amp;</span> <span class="sh-literal">1</span>;

    <span class="sh-comment">// Only publish if the state has changed</span>
    <span class="sh-keyword">if</span> (<span class="sh-variable">isLocked</span> <span class="sh-operator">!=</span> <span class="sh-variable">lastReportedLockState</span>) {
      <span class="sh-variable">myDevice</span>.<span class="sh-function">publishTo</span>(<span class="sh-variable">LOCK_TOPIC</span>, <span class="sh-variable">isLocked</span> ? <span class="sh-string">"true"</span> : <span class="sh-string">"false"</span>);
      <span class="sh-variable">lastReportedLockState</span> <span class="sh-operator">=</span> <span class="sh-variable">isLocked</span>;
    }
    <span class="sh-keyword">if</span> (<span class="sh-variable">isDoorOpen</span> <span class="sh-operator">!=</span> <span class="sh-variable">lastReportedDoorState</span>) {
      <span class="sh-variable">myDevice</span>.<span class="sh-function">publishTo</span>(<span class="sh-variable">DOOR_TOPIC</span>, <span class="sh-variable">isDoorOpen</span> ? <span class="sh-string">"true"</span> : <span class="sh-string">"false"</span>);
      <span class="sh-variable">lastReportedDoorState</span> <span class="sh-operator">=</span> <span class="sh-variable">isDoorOpen</span>;
    }
  }
}</code></pre>
        </li>
        <li><b><code>triggerActuator()</code>:</b> When a command comes from the cloud, send the corresponding command
          code to the Door Controller over I2C.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">triggerActuator</span>(<span class="sh-type">String</span> <span class="sh-variable">topic</span>, <span class="sh-type">String</span> <span class="sh-variable">command</span>) {
  <span class="sh-keyword">if</span> (<span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">LOCK_TOPIC</span>) {
    <span class="sh-class">Wire</span>.<span class="sh-function">beginTransmission</span>(<span class="sh-variable">DOOR_CONTROLLER_ADDRESS</span>);
    <span class="sh-keyword">if</span> (<span class="sh-variable">command</span> <span class="sh-operator">==</span> <span class="sh-string">"true"</span>) {
      <span class="sh-class">Wire</span>.<span class="sh-function">write</span>(<span class="sh-literal">2</span>); <span class="sh-comment">// Send command code 2 for LOCK</span>
    } <span class="sh-keyword">else</span> {
      <span class="sh-class">Wire</span>.<span class="sh-function">write</span>(<span class="sh-literal">1</span>); <span class="sh-comment">// Send command code 1 for UNLOCK</span>
    }
    <span class="sh-class">Wire</span>.<span class="sh-function">endTransmission</span>();
  }
}</code></pre>
        </li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Success Criteria</h4>
      <p class="text-secondary">Your mission succeeds when the ESP8266 can correctly report the door and lock status
        (from the controller) to the cloud, and can successfully send lock/unlock commands from the cloud to the
        controller.</p>
    </div>

    <div id="station5" class="page">
      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">Station 5: Calibrated Curtain
        (Advanced)</h2>
      <h3 class="text-xl font-bold text-primary mb-3">Your Mission: The Precision Engineers</h3>
      <p class="text-secondary">Your team will integrate a high-precision curtain system. Your ESP8266 will manage a
        dedicated <strong>I2C Stepper Controller</strong> that handles a stepper motor. Your main tasks are to command
        the controller to <strong>calibrate</strong> itself using limit switches (photointerrupters) and then control
        the curtain's position with a percentage (0-100%), just like a dimmable light.</p>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Real-World Application:</h4>
      <p class="text-secondary">This is how precise automated systems, from 3D printers to robotic arms, work. A main
        computer sends high-level goals (e.g., "go to 50%"), and a dedicated controller handles the complex, real-time
        motion.</p>

      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Hardware Kit</h4>
      <ul class="list-disc list-inside pl-4 space-y-1">
        <li>1x ESP8266 Board & Breadboard</li>
        <li>1x Pre-Programmed I2C Stepper Curtain Controller Module</li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Wiring Guide (I2C)</h4>
      <p class="text-secondary mb-4">You only need to connect your ESP8266 to the Stepper Controller module via I2C. All
        motors and sensors are pre-wired to the controller.</p>
      <img src="Assets/station5-diagram.png" alt="Wiring Diagram for Station 5 with I2C Module"
        class="w-full rounded-2xl my-4 border border-custom-border">
      <ol class="list-decimal list-inside pl-4 space-y-2">
        <li><strong>I2C Communication:</strong>
          <ul>
            <li>Connect ESP8266 pin <code>PIN_D2</code> (SDA) to the Stepper Controller's <strong>SDA</strong> pin.</li>
            <li>Connect ESP8266 pin <code>PIN_D1</code> (SCL) to the Stepper Controller's <strong>SCL</strong> pin.</li>
            <li>Connect a <code>GND</code> pin from the ESP8266 to the Stepper Controller's <strong>GND</strong> pin.
            </li>
          </ul>
        </li>
      </ol>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Coding Mission: The ESP8266 Manager</h4>
      <p class="text-secondary">Your code will tell the controller to calibrate, send it percentage-based commands, and
        request its current status to report back to the cloud.</p>
      <ul class="list-disc list-inside pl-4 space-y-4">
        <li><b>Libraries, Variables, & Config:</b> Add <code>Wire.h</code> and set the controller's I2C address.
          <pre><code class="language-cpp"><span class="sh-comment">// 1. LIBRARY INCLUSIONS</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;SmartDevice.h&gt;</span>
<span class="sh-preprocessor">#include</span> <span class="sh-string">&lt;Wire.h&gt;</span>

<span class="sh-comment">// 2. VARIABLE DEFINITIONS</span>
<span class="sh-keyword">const int</span> <span class="sh-variable">CURTAIN_CONTROLLER_ADDRESS</span> <span class="sh-operator">=</span> <span class="sh-literal">0x09</span>;
<span class="sh-keyword">int</span> <span class="sh-variable">lastReportedPercent</span> <span class="sh-operator">=</span> <span class="sh-operator">-</span><span class="sh-literal">1</span>; <span class="sh-comment">// Start at -1 to force initial report</span>

<span class="sh-comment">// 3. CONFIGURATION</span>
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">DEVICE_NAME</span> <span class="sh-operator">=</span> <span class="sh-string">"YourName_Curtain_Manager"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">CURTAIN_TOPIC</span> <span class="sh-operator">=</span> <span class="sh-string">"classroom/curtain"</span>;

<span class="sh-comment">// 4. OBJECT DECLARATIONS</span>
<span class="sh-class">SmartDevice</span> <span class="sh-variable">myDevice</span>;</code></pre>
        </li>
        <li><b><code>setupDevice()</code>:</b> Initialize I2C and send the initial calibration command.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">setupDevice</span>() {
  <span class="sh-class">Wire</span>.<span class="sh-function">begin</span>(<span class="sh-keyword">PIN_D2</span>, <span class="sh-keyword">PIN_D1</span>); <span class="sh-comment">// SDA, SCL</span>
  <span class="sh-variable">myDevice</span>.<span class="sh-function">subscribeTo</span>(<span class="sh-variable">CURTAIN_TOPIC</span>);
  
  <span class="sh-comment">// Tell the controller to start its calibration routine</span>
  <span class="sh-class">Wire</span>.<span class="sh-function">beginTransmission</span>(<span class="sh-variable">CURTAIN_CONTROLLER_ADDRESS</span>);
  <span class="sh-class">Wire</span>.<span class="sh-function">write</span>(<span class="sh-string">'C'</span>); <span class="sh-comment">// 'C' for Calibrate</span>
  <span class="sh-class">Wire</span>.<span class="sh-function">endTransmission</span>();
}</code></pre>
        </li>
        <li><b><code>readSensor()</code>:</b> Periodically ask the controller for its current position and report it.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">readSensor</span>() {
  <span class="sh-class">Wire</span>.<span class="sh-function">requestFrom</span>(<span class="sh-variable">CURTAIN_CONTROLLER_ADDRESS</span>, <span class="sh-literal">1</span>);
  <span class="sh-keyword">if</span> (<span class="sh-class">Wire</span>.<span class="sh-function">available</span>()) {
    <span class="sh-keyword">int</span> <span class="sh-variable">currentPercent</span> <span class="sh-operator">=</span> <span class="sh-class">Wire</span>.<span class="sh-function">read</span>();
    <span class="sh-keyword">if</span> (<span class="sh-variable">currentPercent</span> <span class="sh-operator">!=</span> <span class="sh-variable">lastReportedPercent</span>) {
      <span class="sh-comment">// For the cloud, we send a DimmedLight-compatible JSON command</span>
      <span class="sh-type">String</span> <span class="sh-variable">payload</span> <span class="sh-operator">=</span> <span class="sh-string">"{\"swi\":true, \"bri\":"</span> <span class="sh-operator">+</span> <span class="sh-function">String</span>(<span class="sh-variable">currentPercent</span>) <span class="sh-operator">+</span> <span class="sh-string">"}"</span>;
      <span class="sh-variable">myDevice</span>.<span class="sh-function">publishTo</span>(<span class="sh-variable">CURTAIN_TOPIC</span>, <span class="sh-variable">payload</span>);
      <span class="sh-variable">lastReportedPercent</span> <span class="sh-operator">=</span> <span class="sh-variable">currentPercent</span>;
    }
  }
}</code></pre>
        </li>
        <li><b><code>triggerActuator()</code>:</b> When a "DimmedLight" command comes from the cloud, extract the
          brightness and send it as a percentage to the controller.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">triggerActuator</span>(<span class="sh-type">String</span> <span class="sh-variable">topic</span>, <span class="sh-type">String</span> <span class="sh-variable">command</span>) {
  <span class="sh-keyword">if</span> (<span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">CURTAIN_TOPIC</span>) {
    <span class="sh-class">SmartHome::Light</span> <span class="sh-variable">curtainCmd</span> <span class="sh-operator">=</span> <span class="sh-class">SmartDevice</span>::<span class="sh-function">commandToLight</span>(<span class="sh-variable">command</span>);
    
    <span class="sh-class">Wire</span>.<span class="sh-function">beginTransmission</span>(<span class="sh-variable">CURTAIN_CONTROLLER_ADDRESS</span>);
    <span class="sh-class">Wire</span>.<span class="sh-function">write</span>(<span class="sh-string">'P'</span>); <span class="sh-comment">// 'P' for Set Percent</span>
    <span class="sh-class">Wire</span>.<span class="sh-function">write</span>((<span class="sh-keyword">byte</span>)<span class="sh-variable">curtainCmd</span>.<span class="sh-variable">brightness</span>); <span class="sh-comment">// Send brightness (0-100) as the percentage</span>
    <span class="sh-class">Wire</span>.<span class="sh-function">endTransmission</span>();
  }
}</code></pre>
        </li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Success Criteria</h4>
      <p class="text-secondary">Your mission succeeds when the curtain calibrates on startup, and you can precisely
        control its position from 0% to 100% using the slider on the central dashboard.</p>
    </div>

    <div id="station6" class="page">
      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">Station 6: Master Control
        Panel</h2>
      <h3 class="text-xl font-bold text-primary mb-3">Your Mission: The Master Orchestrators</h3>
      <p class="text-secondary">Your team will build a universal remote panel with buttons to send commands and a
        4-channel relay module to light up 24V indicator LEDs showing the status of other devices.</p>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Real-World Application:</h4>
      <p class="text-secondary">Imagine a control panel in a meeting room for lights, thermostat, and projector. You are
        creating a miniature version of such a system, capable of interacting with multiple devices.</p>

      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Hardware Kit</h4>
      <ul class="list-disc list-inside pl-4 space-y-1">
        <li>1x ESP8266 Board & Breadboard</li>
        <li>4x Push Buttons</li>
        <li>1x 4-Channel Relay Module</li>
        <li>(24V Power Supply and LEDs are provided separately)</li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Wiring Guide</h4>
      <p class="text-secondary mb-4">You will wire buttons as inputs and the relay module signal pins as outputs. The
        relay module safely switches the high-voltage (24V) LEDs.</p>
      <img src="Assets/station6-diagram.png" alt="Wiring Diagram for Station 6 with Relay"
        class="w-full rounded-2xl my-4 border border-custom-border">
      <ol class="list-decimal list-inside pl-4 space-y-2">
        <li><b>Push Buttons:</b> Connect one leg of each button to <code>PIN_D1</code>, <code>PIN_D2</code>,
          <code>PIN_D3</code>, and <code>PIN_D4</code>. Connect the other leg of each button to <code>GND</code>.
        </li>
        <li><strong>Relay Module:</strong>
          <ul>
            <li>Connect the relay module's <strong>VCC</strong> and <strong>GND</strong> to the 5V and GND pins on the
              ESP8266.</li>
            <li>Connect the relay signal pins <strong>IN1, IN2, IN3, IN4</strong> to ESP8266 pins <code>PIN_D5</code>,
              <code>PIN_D6</code>, <code>PIN_D7</code>, and <code>PIN_D8</code> respectively.
            </li>
          </ul>
        </li>
      </ol>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Coding Mission: Step-by-Step</h4>
      <p class="text-secondary">The logic for this station is more advanced. When a button is pressed, you must create
        and send a full JSON command for lights, or a simple "true"/"false" for boolean devices.</p>
      <ul class="list-disc list-inside pl-4 space-y-4">
        <li><b>Variables, Config & Objects:</b> Use arrays to manage pins, topics, and states.
          <pre><code class="language-cpp"><span class="sh-comment">// 2. VARIABLE DEFINITIONS</span>
<span class="sh-keyword">const int</span> <span class="sh-variable">NUM_CONTROLS</span> <span class="sh-operator">=</span> <span class="sh-literal">4</span>;
<span class="sh-keyword">int</span> <span class="sh-variable">BTN_PINS</span>[] <span class="sh-operator">=</span> {<span class="sh-keyword">PIN_D1</span>, <span class="sh-keyword">PIN_D2</span>, <span class="sh-keyword">PIN_D3</span>, <span class="sh-keyword">PIN_D4</span>};
<span class="sh-keyword">int</span> <span class="sh-variable">RELAY_PINS</span>[] <span class="sh-operator">=</span> {<span class="sh-keyword">PIN_D5</span>, <span class="sh-keyword">PIN_D6</span>, <span class="sh-keyword">PIN_D7</span>, <span class="sh-keyword">PIN_D8</span>};
<span class="sh-keyword">bool</span> <span class="sh-variable">lastBtnStates</span>[] <span class="sh-operator">=</span> {<span class="sh-literal">HIGH</span>, <span class="sh-literal">HIGH</span>, <span class="sh-literal">HIGH</span>, <span class="sh-literal">HIGH</span>};
<span class="sh-keyword">bool</span> <span class="sh-variable">deviceStates</span>[] <span class="sh-operator">=</span> {<span class="sh-literal">false</span>, <span class="sh-literal">false</span>, <span class="sh-literal">false</span>, <span class="sh-literal">false</span>};

<span class="sh-comment">// 3. CONFIGURATION</span>
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">DEVICE_NAME</span> <span class="sh-operator">=</span> <span class="sh-string">"YourName_ControlPanel"</span>;
<span class="sh-keyword">const char</span><span class="sh-operator">*</span> <span class="sh-variable">TOPICS</span>[] <span class="sh-operator">=</span> {<span class="sh-string">"classroom/lights"</span>, <span class="sh-string">"classroom/kettle"</span>, <span class="sh-string">"classroom/light"</span>, <span class="sh-string">"classroom/hvac"</span>};

<span class="sh-comment">// 4. OBJECT DECLARATIONS</span>
<span class="sh-class">SmartDevice</span> <span class="sh-variable">myDevice</span>;</code></pre>
        </li>
        <li><b><code>setupDevice()</code>:</b> Use loops to configure all pins and subscribe to all topics.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">setupDevice</span>() {
  <span class="sh-keyword">for</span> (<span class="sh-keyword">int</span> <span class="sh-variable">i</span> <span class="sh-operator">=</span> <span class="sh-literal">0</span>; <span class="sh-variable">i</span> <span class="sh-operator">&lt;</span> <span class="sh-variable">NUM_CONTROLS</span>; <span class="sh-variable">i</span><span class="sh-operator">++</span>) {
    <span class="sh-function">pinMode</span>(<span class="sh-variable">BTN_PINS</span>[<span class="sh-variable">i</span>], <span class="sh-literal">INPUT_PULLUP</span>);
    <span class="sh-function">pinMode</span>(<span class="sh-variable">RELAY_PINS</span>[<span class="sh-variable">i</span>], <span class="sh-literal">OUTPUT</span>);
    <span class="sh-function">digitalWrite</span>(<span class="sh-variable">RELAY_PINS</span>[<span class="sh-variable">i</span>], <span class="sh-literal">HIGH</span>); <span class="sh-comment">// Relays often need HIGH to be OFF</span>
    <span class="sh-variable">myDevice</span>.<span class="sh-function">subscribeTo</span>(<span class="sh-variable">TOPICS</span>[<span class="sh-variable">i</span>]);
  }
}</code></pre>
        </li>
        <li><b><code>readSensor()</code>:</b> When a button is pressed, toggle the state and construct the correct
          payload to publish.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">readSensor</span>() {
  <span class="sh-keyword">for</span> (<span class="sh-keyword">int</span> <span class="sh-variable">i</span> <span class="sh-operator">=</span> <span class="sh-literal">0</span>; <span class="sh-variable">i</span> <span class="sh-operator">&lt;</span> <span class="sh-variable">NUM_CONTROLS</span>; <span class="sh-variable">i</span><span class="sh-operator">++</span>) {
    <span class="sh-keyword">bool</span> <span class="sh-variable">currentBtnState</span> <span class="sh-operator">=</span> <span class="sh-function">digitalRead</span>(<span class="sh-variable">BTN_PINS</span>[<span class="sh-variable">i</span>]);
    <span class="sh-keyword">if</span> (<span class="sh-variable">currentBtnState</span> <span class="sh-operator">==</span> <span class="sh-literal">LOW</span> <span class="sh-operator">&amp;&amp;</span> <span class="sh-variable">lastBtnStates</span>[<span class="sh-variable">i</span>] <span class="sh-operator">==</span> <span class="sh-literal">HIGH</span>) {
      <span class="sh-variable">deviceStates</span>[<span class="sh-variable">i</span>] <span class="sh-operator">=</span> <span class="sh-operator">!</span><span class="sh-variable">deviceStates</span>[<span class="sh-variable">i</span>]; <span class="sh-comment">// Toggle state</span>
      
      <span class="sh-type">String</span> <span class="sh-variable">payload</span>;
      <span class="sh-comment">// Check if the topic is for a complex light</span>
      <span class="sh-keyword">if</span> (<span class="sh-function">String</span>(<span class="sh-variable">TOPICS</span>[<span class="sh-variable">i</span>]).<span class="sh-function">indexOf</span>(<span class="sh-string">"light"</span>) <span class="sh-operator">!=</span> <span class="sh-operator">-</span><span class="sh-literal">1</span>) {
        <span class="sh-comment">// Create a JSON command for lights. For simplicity, we just toggle on/off.</span>
        <span class="sh-variable">payload</span> <span class="sh-operator">=</span> <span class="sh-string">"{\"swi\":"</span> <span class="sh-operator">+</span> <span class="sh-function">String</span>(<span class="sh-variable">deviceStates</span>[<span class="sh-variable">i</span>] ? <span class="sh-string">"true"</span> : <span class="sh-string">"false"</span>) <span class="sh-operator">+</span> <span class="sh-string">"}"</span>;
      } <span class="sh-keyword">else</span> {
        <span class="sh-comment">// Create a simple boolean command for other devices</span>
        <span class="sh-variable">payload</span> <span class="sh-operator">=</span> <span class="sh-variable">deviceStates</span>[<span class="sh-variable">i</span>] ? <span class="sh-string">"true"</span> : <span class="sh-string">"false"</span>;
      }
      
      <span class="sh-variable">myDevice</span>.<span class="sh-function">publishTo</span>(<span class="sh-variable">TOPICS</span>[<span class="sh-variable">i</span>], <span class="sh-variable">payload</span>);
      <span class="sh-function">delay</span>(<span class="sh-literal">50</span>);
    }
    <span class="sh-variable">lastBtnStates</span>[<span class="sh-variable">i</span>] <span class="sh-operator">=</span> <span class="sh-variable">currentBtnState</span>;
  }
}</code></pre>
        </li>
        <li><b><code>triggerActuator()</code>:</b> Update the relay and local state based on incoming commands. Note
          that relays are often "active-low", meaning a `LOW` signal turns them ON.
          <pre><code class="language-cpp"><span class="sh-keyword">void</span> <span class="sh-function">triggerActuator</span>(<span class="sh-type">String</span> <span class="sh-variable">topic</span>, <span class="sh-type">String</span> <span class="sh-variable">command</span>) {
  <span class="sh-keyword">for</span> (<span class="sh-keyword">int</span> <span class="sh-variable">i</span> <span class="sh-operator">=</span> <span class="sh-literal">0</span>; <span class="sh-variable">i</span> <span class="sh-operator">&lt;</span> <span class="sh-variable">NUM_CONTROLS</span>; <span class="sh-variable">i</span><span class="sh-operator">++</span>) {
    <span class="sh-keyword">if</span> (<span class="sh-variable">topic</span> <span class="sh-operator">==</span> <span class="sh-variable">TOPICS</span>[<span class="sh-variable">i</span>]) {
      <span class="sh-keyword">bool</span> <span class="sh-variable">newState</span>;
      <span class="sh-comment">// Check for complex light command or simple boolean</span>
      <span class="sh-keyword">if</span> (<span class="sh-variable">command</span>.<span class="sh-function">startsWith</span>(<span class="sh-string">"{"</span>)) {
        <span class="sh-class">SmartHome::Light</span> <span class="sh-variable">lightCmd</span> <span class="sh-operator">=</span> <span class="sh-class">SmartDevice</span>::<span class="sh-function">commandToLight</span>(<span class="sh-variable">command</span>);
        <span class="sh-variable">newState</span> <span class="sh-operator">=</span> <span class="sh-variable">lightCmd</span>.<span class="sh-variable">isOn</span>;
      } <span class="sh-keyword">else</span> {
        <span class="sh-variable">newState</span> <span class="sh-operator">=</span> (<span class="sh-variable">command</span> <span class="sh-operator">==</span> <span class="sh-string">"true"</span>);
      }
      
      <span class="sh-function">digitalWrite</span>(<span class="sh-variable">RELAY_PINS</span>[<span class="sh-variable">i</span>], <span class="sh-variable">newState</span> ? <span class="sh-literal">LOW</span> : <span class="sh-literal">HIGH</span>); <span class="sh-comment">// LOW for ON, HIGH for OFF</span>
      <span class="sh-variable">deviceStates</span>[<span class="sh-variable">i</span>] <span class="sh-operator">=</span> <span class="sh-variable">newState</span>; <span class="sh-comment">// Sync local state</span>
      <span class="sh-keyword">break</span>;
    }
  }
}</code></pre>
        </li>
      </ul>
      <h4 class="text-lg font-bold text-accent mt-6 mb-3">Success Criteria</h4>
      <p class="text-secondary">Your mission succeeds when pressing a button toggles the corresponding device, and the
        relay-controlled LED for that button correctly reflects the device's true state, even when controlled from the
        dashboard.</p>
    </div>

    <div id="api-reference" class="page">
      <h1 class="text-4xl md:text-5xl font-bold text-center text-primary mb-4">API Reference: SmartDevice Library</h1>
      <p class="text-center text-secondary text-lg mb-8">This is your reference for the <code>SmartDevice</code>
        library, your tool for connecting your IoT device to the Smart Classroom Hub.</p>

      <hr />

      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">GPIO Pin Definitions</h2>
      <p class="text-secondary">Use these friendly pin names in your code to avoid conflicts with system pins.</p>
      <table class="w-full text-left text-secondary">
        <thead>
          <tr>
            <th class="py-3 px-4">Macro</th>
            <th class="py-3 px-4">GPIO Pin</th>
            <th class="py-3 px-4">Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="py-2 px-4"><code>PIN_D0</code></td>
            <td class="py-2 px-4">16</td>
            <td class="py-2 px-4">HIGH at boot, used for deep sleep wake.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>PIN_D1</code></td>
            <td class="py-2 px-4">5</td>
            <td class="py-2 px-4">Safe to use. I2C SCL.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>PIN_D2</code></td>
            <td class="py-2 px-4">4</td>
            <td class="py-2 px-4">Safe to use. I2C SDA.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>PIN_D3</code></td>
            <td class="py-2 px-4">0</td>
            <td class="py-2 px-4">Connected to Flash button, boot fails if LOW.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>PIN_D4</code></td>
            <td class="py-2 px-4">2</td>
            <td class="py-2 px-4">HIGH at boot, boot fails if LOW.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>PIN_D5</code></td>
            <td class="py-2 px-4">14</td>
            <td class="py-2 px-4">Safe to use.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>PIN_D6</code></td>
            <td class="py-2 px-4">12</td>
            <td class="py-2 px-4">Safe to use.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>PIN_D7</code></td>
            <td class="py-2 px-4">13</td>
            <td class="py-2 px-4">Safe to use.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>PIN_D8</code></td>
            <td class="py-2 px-4">15</td>
            <td class="py-2 px-4">Required for boot, boot fails if HIGH.</td>
          </tr>
        </tbody>
      </table>

      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">SmartHome Namespace</h2>
      <p class="text-secondary">The <code>SmartHome</code> namespace contains data types for IoT variables, simplifying
        how you handle complex data like smart lights.</p>

      <h3 class="text-xl font-bold text-primary mb-3"><code>enum LightType</code></h3>
      <p class="text-secondary mt-2">Defines the type of light being controlled.</p>
      <ul class="list-disc list-inside pl-4 space-y-2 text-secondary">
        <li><code>DIMMABLE</code>: A light that can be turned on/off and have its brightness adjusted.</li>
        <li><code>COLOR</code>: A light that has on/off, brightness, and color (hue/saturation) control.</li>
      </ul>

      <h3 class="text-xl font-bold text-primary mb-3"><code>struct Light</code></h3>
      <p class="text-secondary mt-2">Represents the state of a smart light. The <code>commandToLight</code> function
        populates this struct for you from an incoming command.</p>
      <table class="w-full text-left text-secondary">
        <thead>
          <tr>
            <th class="py-3 px-4">Member</th>
            <th class="py-3 px-4">Type</th>
            <th class="py-3 px-4">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="py-2 px-4"><code>isOn</code></td>
            <td class="py-2 px-4"><code>bool</code></td>
            <td class="py-2 px-4"><code>true</code> if ON, <code>false</code> if OFF.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>brightness</code></td>
            <td class="py-2 px-4"><code>int</code></td>
            <td class="py-2 px-4">Brightness level (0-100).</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>hue</code></td>
            <td class="py-2 px-4"><code>int</code></td>
            <td class="py-2 px-4">Color hue (0-360). Only for <code>COLOR</code> lights.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>saturation</code></td>
            <td class="py-2 px-4"><code>int</code></td>
            <td class="py-2 px-4">Color saturation (0-100). Only for <code>COLOR</code> lights.</td>
          </tr>
          <tr>
            <td class="py-2 px-4"><code>type</code></td>
            <td class="py-2 px-4"><code>LightType</code></td>
            <td class="py-2 px-4">Specifies if the light is <code>DIMMABLE</code> or <code>COLOR</code>.</td>
          </tr>
        </tbody>
      </table>

      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">SmartDevice Class</h2>
      <p class="text-secondary">The main class for handling all networking and communication.</p>

      <h3 class="text-xl font-bold text-primary mb-3">Core Methods</h3>
      <div class="highlight-box">
        <h4 class="font-bold text-accent">
          <code>void begin(const char* deviceName, const char* wifi_ssid, const char* wifi_pass, const char* mqtt_broker)</code>
        </h4>
        <p class="text-sm text-secondary">Initializes the device, connects to Wi-Fi, and connects to the MQTT Hub. Call
          this once in your main <code>setup()</code> function.</p>
      </div>
      <div class="highlight-box">
        <h4 class="font-bold text-accent"><code>void update()</code></h4>
        <p class="text-sm text-secondary">Keeps the device connected and processes messages. This <b>must</b> be called
          in every iteration of your main <code>loop()</code>.</p>
      </div>
      <div class="highlight-box">
        <h4 class="font-bold text-accent"><code>void publishTo(String fullTopic, String payload)</code></h4>
        <p class="text-sm text-secondary">Publishes a message to a specific MQTT topic. Use this to send sensor data or
          status updates.</p>
      </div>
      <div class="highlight-box">
        <h4 class="font-bold text-accent"><code>void subscribeTo(String fullTopic)</code></h4>
        <p class="text-sm text-secondary">Subscribes your device to a topic to receive messages, like commands from the
          hub.</p>
      </div>
      <div class="highlight-box">
        <h4 class="font-bold text-accent"><code>void onMessage(MessageCallback callback)</code></h4>
        <p class="text-sm text-secondary">Registers your handler function (like <code>triggerActuator</code>) to be
          called when any message is received.</p>
      </div>
      <div class="highlight-box">
        <h4 class="font-bold text-accent"><code>bool isConnected()</code></h4>
        <p class="text-sm text-secondary">Returns <code>true</code> if the device is currently connected to the MQTT
          Hub, <code>false</code> otherwise.</p>
      </div>

      <h3 class="text-xl font-bold text-primary mb-3">Static Helper Functions</h3>
      <p class="text-secondary">These functions are helpers that you can call directly from the <code>SmartDevice</code>
        class without needing an object. They make common tasks, especially for lighting, much simpler.</p>
      <div class="highlight-box">
        <h4 class="font-bold text-accent"><code>static SmartHome::Light commandToLight(String command)</code></h4>
        <p class="text-sm text-secondary">Parses an incoming JSON command string into an easy-to-use <code>Light</code>
          struct. This is the first step in handling any light command.</p>
        <pre
          class="mt-4"><code><span class="sh-comment">// In triggerActuator:</span>
<span class="sh-class">SmartHome::Light</span> <span class="sh-variable">lightCmd</span> <span class="sh-operator">=</span> <span class="sh-class">SmartDevice</span>::<span class="sh-function">commandToLight</span>(<span class="sh-variable">command</span>);
<span class="sh-keyword">if</span> (<span class="sh-variable">lightCmd</span>.<span class="sh-variable">isOn</span>) { <span class="sh-comment">/* ... */</span> }</code></pre>
      </div>
      <div class="highlight-box">
        <h4 class="font-bold text-accent"><code>static uint32_t getRGB(SmartHome::Light lightCommand)</code></h4>
        <p class="text-sm text-secondary">Converts a <code>Light</code> struct into a single color value that the
          NeoPixel library can understand. It handles both full color (from hue/saturation) and dimmable white
          (grayscale).</p>
        <pre class="mt-4"><code><span class="sh-comment">// For NeoPixel strips:</span>
<span class="sh-variable">strip</span>.<span class="sh-function">fill</span>(<span class="sh-class">SmartDevice</span>::<span class="sh-function">getRGB</span>(<span class="sh-variable">lightCmd</span>));
<span class="sh-variable">strip</span>.<span class="sh-function">show</span>();</code></pre>
      </div>
      <div class="highlight-box">
        <h4 class="font-bold text-accent"><code>static uint8_t getBrightnessValue(SmartHome::Light lightCommand)</code>
        </h4>
        <p class="text-sm text-secondary">Gets a brightness value (0-255) suitable for a standard dimmable LED using
          <code>analogWrite()</code>. It converts the 0-100 brightness from the command.
        </p>
        <pre
          class="mt-4"><code><span class="sh-comment">// For standard dimmable LEDs:</span>
<span class="sh-function">analogWrite</span>(<span class="sh-variable">BULB_PIN</span>, <span class="sh-class">SmartDevice</span>::<span class="sh-function">getBrightnessValue</span>(<span class="sh-variable">lightCmd</span>));</code></pre>
      </div>
    </div>

    <div id="upload-troubleshoot" class="page">
      <h1 class="text-4xl md:text-5xl font-bold text-center text-primary mb-4">Upload & Troubleshooting Guide</h1>
      <p class="text-center text-secondary text-lg mb-8">Encountering issues is a normal part of engineering! This guide
        helps you diagnose and solve common problems.</p>

      <hr />

      <h2 class="text-3xl font-bold text-primary border-b border-custom-border pb-3 mb-6">Common Bug Hotspots &
        Solutions</h2>

      <div class="highlight-box">
        <h3 class="font-bold text-accent mb-2">1. Wi-Fi / Network Connection Issues</h3>
        <p class="text-sm text-secondary">Your device can't connect or send/receive messages.</p>
        <ul class="list-disc list-inside pl-4 mt-3 space-y-2 text-secondary text-sm">
          <li><b>Incorrect Credentials:</b> Double-check the Wi-Fi SSID, Password, and MQTT Broker IP Address in your
            template's Configuration section. One typo can break everything.</li>
          <li><b>"System Engine" Modified:</b> The networking code at the bottom of the template should <b>NEVER</b> be
            edited. If you suspect changes, get a fresh copy of the template.</li>
          <li><b>Use the Serial Monitor:</b> Open the Serial Monitor (Tools > Serial Monitor) with baud rate
            <code>115200</code>. It will print status messages like "Connecting...", "Connected!", or "MQTT connection
            failed", which are vital for diagnosis.
          </li>
        </ul>
      </div>

      <div class="highlight-box">
        <h3 class="font-bold text-accent mb-2">2. Code Logic & Syntax Errors</h3>
        <p class="text-sm text-secondary">Your code won't compile or run as expected.</p>
        <ul class="list-disc list-inside pl-4 mt-3 space-y-2 text-secondary text-sm">
          <li><b>Compiler Errors:</b> Read the red error messages in the Arduino IDE's bottom pane. They usually tell
            you the file and line number of the error. Look for missing semicolons (<code>;</code>), mismatched brackets
            <code>{}</code>/<code>()</code>, or typos.
          </li>
          <li><b>Library Issues:</b> If you add a new library (e.g., <code>#include &lt;DHT.h&gt;</code>), make sure
            it's installed via the Library Manager (Sketch > Include Library > Manage Libraries...).</li>
          <li><b>Logic Bugs:</b> If the code runs but does the wrong thing, use <code>Serial.println()</code>
            everywhere! Print variable values to see what your program is actually doing. This is the #1 debugging
            technique.</li>
        </ul>
      </div>

      <div class="highlight-box">
        <h3 class="font-bold text-accent mb-2">3. Upload / Port Issues</h3>
        <p class="text-sm text-secondary">Problems getting your code onto the ESP8266.</p>
        <ul class="list-disc list-inside pl-4 mt-3 space-y-2 text-secondary text-sm">
          <li><b>Incorrect Board/Port:</b> Go to "Tools" and ensure you've selected the correct Board (usually "Generic
            ESP8266 Module") and Port (the one that appears when you plug in your board).</li>
          <li><b>Upload Fails ("A fatal error occurred"):</b> Some boards require you to <b>press and hold the "FLASH"
              or "BOOT" button</b> while clicking "Upload". Release it once the "Connecting..." message appears in the
            IDE.</li>
          <li><b>Driver Issues:</b> If no Port appears, you may need to install a USB-to-Serial driver (like CH340 or
            CP2102) for your board. Ask an instructor for help.</li>
        </ul>
      </div>

      <div class="highlight-box">
        <h3 class="font-bold text-accent mb-2">4. Physical Wiring Mistakes</h3>
        <p class="text-sm text-secondary">Perfect code won't work with bad wiring.</p>
        <ul class="list-disc list-inside pl-4 mt-3 space-y-2 text-secondary text-sm">
          <li><b>Check Pin Numbers:</b> Make sure the physical pin on the board matches the pin you defined in your code
            (e.g., physical pin D1 corresponds to <code>PIN_D1</code>).</li>
          <li><b>Loose Connections:</b> Gently push on all your jumper wires to ensure they are firmly seated in the
            breadboard and ESP8266 headers.</li>
          <li><b>Power and Ground:</b> The most common issue! Ensure all components share a common ground (GND) with the
            ESP8266 and are connected to the correct voltage (3.3V or 5V).</li>
        </ul>
      </div>
      <p class="text-center text-secondary text-lg mt-8">If you're stuck after checking these, ask an instructor!
        They're here to help you succeed.</p>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // --- DOM Element References ---
      const pages = document.querySelectorAll('.page');
      const navLinks = document.querySelectorAll('.nav-item, .dropdown-item');
      const dropdownContainer = document.getElementById('dropdown-container');
      const dropdownButton = document.getElementById('nav-missions-btn');
      const dropdownMenu = document.getElementById('dropdown-menu');
      const dropdownArrow = document.getElementById('dropdown-arrow');

      function showPage(pageId) {
        pages.forEach(page => page.classList.remove('active'));

        const activePage = document.getElementById(pageId);
        if (activePage) {
          activePage.classList.add('active');
        }

        navLinks.forEach(link => {
          const isDropdownButton = link.id === 'nav-missions-btn';
          const isForCurrentPage = link.dataset.page === pageId;
          const isDropdownPageActive = activePage && activePage.id.startsWith('station');

          link.classList.remove('bg-accent', 'text-custom-bg', 'font-bold');
          link.classList.add('text-secondary', 'hover:bg-custom-border', 'hover:text-primary');

          if (isForCurrentPage && !link.classList.contains('dropdown-item')) {
            link.classList.add('bg-accent', 'text-custom-bg', 'font-bold');
            link.classList.remove('text-secondary', 'hover:bg-custom-border', 'hover:text-primary');
          }
          else if (isDropdownButton && isDropdownPageActive) {
            link.classList.add('bg-accent', 'text-custom-bg', 'font-bold');
            link.classList.remove('text-secondary', 'hover:bg-custom-border', 'hover:text-primary');
          }
        });

        closeDropdown();
        // Call chart rendering function when the infographic page is active
        if (pageId === 'overview') {
          renderInfographicCharts();
        }
      }

      function openDropdown() {
        dropdownMenu.classList.remove('hidden');
        dropdownArrow.style.transform = 'rotate(180deg)';
      }

      function closeDropdown() {
        dropdownMenu.classList.add('hidden');
        dropdownArrow.style.transform = 'rotate(0deg)';
      }

      // --- Event Listeners ---
      navLinks.forEach(link => {
        if (link.dataset.page) {
          link.addEventListener('click', (e) => {
            e.preventDefault();
            showPage(link.dataset.page);
            window.scrollTo(0, 0);
          });
        }
      });

      dropdownButton.addEventListener('click', (event) => {
        event.stopPropagation();
        const isHidden = dropdownMenu.classList.contains('hidden');
        if (isHidden) {
          openDropdown();
        } else {
          closeDropdown();
        }
      });

      window.addEventListener('click', (event) => {
        if (!dropdownContainer.contains(event.target)) {
          closeDropdown();
        }
      });

      // --- Initialization ---
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.add('text-secondary', 'hover:bg-custom-border', 'hover:text-primary');
      });
      document.querySelectorAll('.dropdown-item').forEach(item => {
        item.classList.add('block', 'w-full', 'text-left', 'px-4', 'py-2', 'text-sm', 'text-primary', 'hover:bg-accent', 'hover:text-custom-bg', 'transition-colors', 'rounded-lg');
      });

      showPage('home'); // Show home page on initial load

      // Chart rendering function for the infographic page
      function renderInfographicCharts() {
        // Utility function to wrap Chart.js labels
        function wrapLabel(label, maxLength = 16) {
          if (label.length <= maxLength) {
            return label;
          }
          const words = label.split(' ');
          let lines = [];
          let currentLine = '';
          words.forEach(word => {
            if ((currentLine + word).length > maxLength && currentLine.length > 0) {
              lines.push(currentLine.trim());
              currentLine = word + ' ';
            } else {
              currentLine += word + ' ';
            }
          });
          if (currentLine.length > 0) {
            lines.push(currentLine.trim());
          }
          return lines;
        }

        const tooltipConfig = {
          plugins: {
            tooltip: {
              callbacks: {
                title: function (tooltipItems) {
                  const item = tooltipItems[0];
                  let label = item.chart.data.labels[item.dataIndex];
                  if (Array.isArray(label)) {
                    return label.join(' ');
                  }
                  return label;
                }
              }
            },
            legend: { // Also define legend callbacks for proper multi-line labels if needed
              labels: {
                color: '#BDC1C6', // Secondary text color for legend
                padding: 20,
                font: { family: 'Product Sans' }
              }
            }
          }
        };

        // Chart 2: Troubleshooting Hotspots (Doughnut Chart)
        const troubleshootingCtx = document.getElementById('troubleshootingChart');
        if (troubleshootingCtx) { // Check if canvas exists on the current page
          const existingChart = Chart.getChart(troubleshootingCtx);
          if (existingChart) existingChart.destroy(); // Destroy previous instance to prevent duplicates

          new Chart(troubleshootingCtx.getContext('2d'), {
            type: 'doughnut',
            data: {
              labels: [
                wrapLabel('Wi-Fi / Network Connection'),
                wrapLabel('Code Logic & Syntax Errors'),
                wrapLabel('Upload / Port Issues'),
                wrapLabel('Physical Wiring Mistakes')
              ],
              datasets: [{
                label: 'Common Bug Hotspots',
                data: [40, 30, 20, 10], /* Example data distribution */
                backgroundColor: ['#8ab4f8', '#ef5350', '#ffb300', '#2196f3'], /* Accent, Error-Red, Warning-Yellow, Info-Blue */
                borderColor: 'transparent', /* Removed border */
                borderWidth: 0,
                hoverOffset: 4
              }]
            },
            options: {
              ...tooltipConfig,
              maintainAspectRatio: false,
              cutout: '60%', /* Doughnut thickness */
              plugins: {
                ...tooltipConfig.plugins,
                legend: {
                  display: false /* Removed legend */
                }
              }
            }
          });
        }
      }
    });
  </script>

</body>

</html>